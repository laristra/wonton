<!--
This file is part of the Ristra wonton project.
Please see the license file at the root of this repository, or at:
    https://github.com/laristra/wonton/blob/master/LICENSE
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="Doxygen 1.8.13"/>
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- Font stuff -->
    <link href='//fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'/>
    <script src="//use.fontawesome.com/3dce4d8e65.js"></script>
    <!-- the default version jquery provided by doxygen is too old for bootstrap
	 but it also contains local modifications.  we have extracted those that
	 are needed so that we can use a newer jquery. -->
    <!-- <script type="text/javascript" src="//code.jquery.com/jquery-3.1.1.min.js"></script> -->
    <script
			  src="//code.jquery.com/jquery-3.3.1.min.js"
			  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
			  crossorigin="anonymous"></script>
      <!-- <script src="//code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
    <script type="text/javascript" src="smartmenu.js"></script>
    <title>wonton: Wonton Concepts</title>
    <link href="tabs.css" rel="stylesheet" type="text/css">
      <!-- this version is too old for bootstrap, but it includes modifications
	   from standard jquery
    <script type="text/javascript" src="jquery.js"></script>  -->
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="//stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!-- <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/> -->
    <!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
  </head>
  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand">wonton </a>
        </div>
      </div>
    </nav>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div class="content" id="content">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 panel " style="padding-bottom: 15px;">
              <div style="margin-bottom: 15px;">
      		<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> Concepts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Wrappers</h2>
<p>Mesh and state or data associated with the mesh are fundamental data structures in any physics based application. In general, the application has its own native data structures with its native interface for data access.</p>
<p>This makes it harder to design generic libraries that can work with different applications with different native APIs. One way to overcome this problem is to access data through a wrapper. A wrapper is an implementation of an interface to the native interface and can be used to avoid data copy between application and the library if the wrapper interface provides the essential queries required by the library.</p>
<p>Both Portage and Tangram are templated on mesh and state wrapper types ensuring that any application code can use them regardless of their native API while avoiding data copy.</p>
<p><a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> primarily serves two purposes:</p><ol type="1">
<li>It defines a common interface to access mesh and field data from any application.</li>
<li>It serves as a repository of example wrappers, specifically to the Jali mesh framework, FleCSI Burton Mesh Specialization and couple of native mesh/state wrappers.</li>
</ol>
<p>We now describe the common interface and its design.</p>
<h3>Mesh Wrapper Design</h3>
<p>The mesh wrappers are designed to use a Curiously Recurring Template Pattern (CRTP) over a base class called <em><a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a></em>. The basic mesh wrapper for a particular framework implements methods for various mesh queries. We will discuss the motivation and use for using CRTP design in the next section. Here we provide an overview of what methods the basic mesh wrapper must provide.</p>
<p>The wrapper class must support cells, faces and nodes and adjacency queries between these entities. In 2D, faces are the same as edges and in 1D, faces are the same as nodes. The mesh wrapper class is expected to support the following methods:</p>
<ol type="1">
<li>Basic<ul>
<li>int space_dimension() const; // dimensionality of mesh points (1, 2, 3)</li>
<li>int num_owned_cells() const;</li>
<li>int num_ghost_cells() const;</li>
<li>int num_owned_faces() const;</li>
<li>int num_ghost_faces() const;</li>
<li>int num_owned_nodes() const;</li>
<li>int num_ghost_nodes() const;</li>
<li>int get_global_id(int const id, Entity_kind const kind) const;</li>
</ul>
</li>
<li>Type information (see for details on <a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> types)<ul>
<li><a class="el" href="namespaceWonton.html#a4ba4d01e597f011be429bc05e6f0cebb" title="The parallel type of a given entity. ">Wonton::Entity_type</a> cell_get_type(int const cellid) const;</li>
<li><a class="el" href="namespaceWonton.html#a4ba4d01e597f011be429bc05e6f0cebb" title="The parallel type of a given entity. ">Wonton::Entity_type</a> node_get_type(int const nodeid) const;</li>
<li><a class="el" href="namespaceWonton.html#a782ada4a682b30fc8e94d58b09b17bcc" title="Element (cell topology) type. ">Wonton::Element_type</a> cell_get_element_type(int const cellid) const;</li>
</ul>
</li>
<li>Topology queries<ul>
<li>void cell_get_faces_and_dirs(int const cellid, std::vector&lt;int&gt; *cfaces, std::vector&lt;int&gt; *cfdirs) const; Here the cfdirs conveys the directions in which the faces are used by the cell. If the natural normal of the face points out of the cell, its direction should be returned as 1, if not, it should be returned as -1</li>
<li>void cell_get_nodes(int const cellid, std::vector&lt;int&gt; *cnodes) const;</li>
<li>void face_get_nodes(int const faceid, std::vector&lt;int&gt; *fnodes) const;</li>
<li>void node_get_cells(int const nodeid, <a class="el" href="namespaceWonton.html#a4ba4d01e597f011be429bc05e6f0cebb" title="The parallel type of a given entity. ">Wonton::Entity_type</a> etype, std::vector&lt;int&gt; *ncells) const;</li>
<li>template&lt;long D&gt; void node_get_coordinates(int const nodeid, Wonton::Point&lt;D&gt; *pp) const;</li>
</ul>
</li>
</ol>
<h3><a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a></h3>
<p>The basic mesh wrapper provides access to the standard entity types and their topological and geometrical information. However, advanced non-standard types such as <em>sides</em>, <em>corners</em>, etc., may not be provided by the mesh framework. Such advanced types are required for some particular algorithms such as nodal remapping, remapping methods for entities with non-planar faces, etc.</p>
<p>Using the CRTP design allows extending the base mesh to support construction of such advanced topological types. Since <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> needs to make some queries about the basic topology, CRTP is used to allow this kind of mutual invocation from the Derived wrapper type.</p>
<p>Using the CRTP design, the basic mesh framework wrapper looks something like</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Basic_Mesh_Wrapper : <span class="keyword">public</span> <a class="code" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a>&lt;Basic_Mesh_Wrapper&gt; {...};</div></div><!-- fragment --><p>In this way, the <code>Basic_Mesh_Wrapper</code> can use its own methods, or defer to <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> to perform more advanced queries.</p>
<p>The definitions of the non-standard subcell entities that the <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> constructs are as follows:</p><ul>
<li>1D: A side is a line segment from a node to the cell. Wedges and corners are the same as the sides.</li>
<li>2D: A side is a triangle formed by the two nodes of an edge/face and the cell center. A wedge is half of a side formed by one node of the edge, the edge center and the cell center. A corner is a quadrilateral formed by the two wedges in a cell at a node.</li>
<li>3D: A side is a tet formed by the two nodes of an edge, a face center and a cell center. A wedge is half a side, formed by a node of the edge, the edge center, the face center and the cell center. A corner is formed by all the wedges of a cell at a node.</li>
</ul>
<div class="image">
<object type="image/svg+xml" data="auxentities.svg">auxentities.svg</object>
<div class="caption">
Illustration for 2D auxiliary entities</div></div>
<p>In addition to the advanced mesh entities (sides, wedges, and corners), <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> also computes some advanced connectivity information. An example is <a class="el" href="classWonton_1_1AuxMeshTopology.html#ab749dbd39a5a47b9d469f2e63647f3e9" title="Get the list of node IDs for all nodes attached to all cells attached to a specific node...">Wonton::AuxMeshTopology::node_get_cell_adj_nodes()</a>, which, given a node index in the mesh, returns a vector of all the nodes that are attached to all cells attached to the given node. <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> additionally creates iterators over all the various types of mesh entities, provides geometric information (e.g. volumes, centroids, etc.) of the mesh entities, and a method to determine if an entitiy is on the domain boundary (needed for limiting in higher-order remaps).</p>
<p><em>If one does <b>not</b> use <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> to help extend their mesh wrapper's functionality, one should ensure that their mesh wrapper at least has the same public functions as <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a>.</em> For this reason, it is advised to utilize <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> where possible, but to defer to one's own mesh framework wrapper when more efficient methods are available.</p>
<h3>Current Support</h3>
<p>At present, <a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> provides the following wrappers to external frameworks:</p><ol type="1">
<li><a href="http://github.com/lanl/jali">Jali</a></li>
<li><a href="http://github.com/laristra/flecsi-sp">FleCSI Burton Specialization</a></li>
</ol>
<p><a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> also provides two native mesh and state managers and their wrappers:</p><ol type="1">
<li><a class="el" href="example.html">Simple Mesh and State</a>: A very light-weight, serial, 2D/3D Cartesian mesh and its state.</li>
<li>Flat Mesh and State: A native framework used internally for redistributing mesh/state data across partitions.</li>
</ol>
<h3>State Wrappers</h3>
<p>There is no equivalent of <a class="el" href="namespaceAuxMeshTopology.html">AuxMeshTopology</a> for state wrappers. This is simply because the requirements of a state manager are much less than those of the mesh framework. In particular, the state wrappers need to know how to add data, get data, and query things like the size of the data and where the data lives (<a class="el" href="namespaceWonton.html#ac53f3e6fa9764c905a442e31623f5396a134bbbf860ead84cd3cca86dcd6db4d4">Wonton::CELL</a> or <a class="el" href="namespaceWonton.html#ac53f3e6fa9764c905a442e31623f5396accf5cd8c72d2351871e7e309be7ad7ee">Wonton::NODE</a>).</p>
<h2>Types</h2>
<p><a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> currently provides the following enumerated types:</p><ol type="1">
<li><em>Entity_kind</em>: The type of mesh entity.<ul>
<li>ALL_KIND, ANY_KIND, UNKNOWN_KIND, NODE, EDGE, FACE, CELL, SIDE, WEDGE, CORNER, FACET, BOUNDARY_FACE, PARTICLE</li>
</ul>
</li>
<li><em>Entity_type</em>: The parallel type of a given entity.<ul>
<li>TYPE_UNKNOWN, DELETED, PARALLEL_OWNED, PARALLEL_GHOST, BOUNDARY_GHOST, ALL</li>
</ul>
</li>
<li><em>Element_type</em>: The cell type<ul>
<li>UNKNOWN_TOPOLOGY, TRI, QUAD, POLYGON, TET, PRISM, PYRAMID, HEX, POLYHEDRON</li>
</ul>
</li>
<li><em>Field_type</em>: Whether the state i.e. the field is a mesh or multi-material field.<ul>
<li>UNKNOWN_TYPE_FIELD, MESH_FIELD, MULTIMATERIAL_FIELD</li>
</ul>
</li>
</ol>
<p><a class="el" href="namespaceWonton.html" title="Factorize a number N into D equal (or nearly equal) factors. ">Wonton</a> also provides types for Points, Vectors and Matrices. These are advanced types with the following operators and methods:</p>
<ul>
<li>Point:<ul>
<li>Operators: [], -p, p+t, c*p, p/c</li>
<li>Methods: asV (convert Point to Vector)</li>
</ul>
</li>
<li>Vector:<ul>
<li>Operators: [], -V, V+U, V-U, sV, V/s,</li>
<li>Methods: norm, one_norm, max_norm, normalize, is_zero, dot, cross, MaxComponent</li>
</ul>
</li>
<li>Matrix:<ul>
<li>Initialization: Using constant value, from vector of vectors, copy</li>
<li>Operators: M = M + C, M = M - C, M = c*M, [], M = M*_v_, M = A*B</li>
<li>Methods: inverse, solve (QR decomposition based), data (return matrix data)</li>
</ul>
</li>
</ul>
<h2>Algorithms</h2>
<ul>
<li>SVD: Double precision SVD routine. Takes an m-by-n matrix A and decomposes it into UDV, where U, V are left and right orthogonal transformation matrices, and D is a diagonal matrix of singular values.</li>
<li>lsfits: Computes a least squares gradient from a set of values. The first point is assumed to be the point where the gradient must be computed and the first value is assumed to the value at this reference point. </li>
</ul>
</div></div><!-- contents -->
<!--
This file is part of the Ristra wonton project.
Please see the license file at the root of this repository, or at:
    https://github.com/laristra/wonton/blob/master/LICENSE
-->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<!--<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address> -->
<footer id="footer" class="footer">
  <div class="container">
    <div class="row test-muted">
      <div class="footer-row col-md-6">Copyright &copy; 2019
	<a href="http://lanl.gov"> Triad National Security, LLC</a>
	All Rights Reserved.
      </div>
      <div class="footer-row col-md-2">
	<a href="https://github.com/laristra/wonton/blob/master/LICENSE">
	  BSD LICENSE
	</a>
      </div>
      <div class="footer-row col-md-2">
	LA-CC-18-019
      </div>
      <div class="footer-row col-md-1">
	<a href="mailto:wonton@lanl.gov">
	  <i class="fa fa-envelope-o fa-2x"></i>
	</a>
      </div>
      <div class="footer-row col-md-1">
	<a href="https://github.com/laristra/wonton">
	  <i class="fa fa-github fa-2x"></i>
	</a>
      </div>
    </div>
  </div>
</footer>
<script type="text/javascript" src="doxy-boot.js"></script>
</body>
</html>
